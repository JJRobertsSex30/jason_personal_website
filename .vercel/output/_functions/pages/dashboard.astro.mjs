import { c as createAstro, a as createComponent, m as maybeRenderHead, d as addAttribute, f as renderScript, b as renderTemplate, r as renderComponent, F as Fragment } from '../chunks/astro/server_DgPtluSo.mjs';
import 'kleur/colors';
import { $ as $$PageLayout } from '../chunks/PageLayout_j_B7ywtx.mjs';
import { s as supabase } from '../chunks/supabaseClient_C6_a71Ro.mjs';
import 'clsx';
/* empty css                                     */
export { renderers } from '../renderers.mjs';

const $$Astro$1 = createAstro("https://astrowind.vercel.app");
const $$ABTestManager = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro$1, $$props, $$slots);
  Astro2.self = $$ABTestManager;
  const { experiments, abTestError } = Astro2.props;
  return renderTemplate`${maybeRenderHead()}<section class="my-8"> <h2 class="text-3xl font-semibold mb-8 text-slate-800 dark:text-white text-center">A/B Test Management</h2>  ${abTestError && renderTemplate`<div class="mb-6 p-4 bg-orange-50 dark:bg-orange-800/30 border border-orange-300 dark:border-orange-600 text-orange-700 dark:text-orange-300 rounded-lg shadow-sm" role="alert"> <p class="font-bold text-lg">A/B Test Error:</p> <p>${abTestError}</p> </div>`}  <div class="mb-10 p-6 bg-white dark:bg-slate-800 shadow-xl rounded-lg"> <h3 class="text-2xl font-semibold mb-6 text-slate-700 dark:text-slate-200">Create New Experiment</h3> <form method="POST"${addAttribute(Astro2.url.pathname, "action")} class="space-y-6"> <input type="hidden" name="_action" value="create_experiment"> <div> <label for="experiment_name" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">
Experiment Name <span class="text-red-500">*</span> </label> <input type="text" id="experiment_name" name="experiment_name" required class="shadow-sm appearance-none border border-slate-300 dark:border-slate-600 rounded-md w-full py-2.5 px-3 text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-slate-400 dark:placeholder-slate-500" placeholder="e.g., Homepage Headline Test"> </div> <div> <label for="experiment_description" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">
Description (Optional)
</label> <textarea id="experiment_description" name="experiment_description" rows="3" class="shadow-sm appearance-none border border-slate-300 dark:border-slate-600 rounded-md w-full py-2.5 px-3 text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-slate-400 dark:placeholder-slate-500" placeholder="Briefly describe the goal of this experiment."></textarea> </div> <div class="flex items-center"> <input id="experiment_is_active" name="experiment_is_active" type="checkbox" checked class="h-4 w-4 text-blue-600 border-slate-300 dark:border-slate-600 rounded focus:ring-blue-500 bg-white dark:bg-slate-700 dark:checked:bg-blue-500"> <label for="experiment_is_active" class="ml-2 block text-sm text-slate-700 dark:text-slate-300">
Activate this experiment immediately
</label> </div> <div class="flex justify-end"> <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-5 rounded-md shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900 transition duration-150 ease-in-out">
Create Experiment
</button> </div> </form> </div>  <h3 class="text-2xl font-semibold mb-6 text-slate-700 dark:text-slate-200 mt-10">Existing Experiments</h3> ${experiments && experiments.length > 0 ? renderTemplate`<div class="space-y-6"> ${experiments.map((exp) => renderTemplate`<div class="bg-white dark:bg-slate-800 shadow-lg rounded-lg p-6"${addAttribute(`experiment-${exp.id}`, "id")}>  <div${addAttribute(`experiment-display-section-${exp.id}`, "class")}> <div class="flex justify-between items-start mb-2"> <div> <h4 class="text-xl font-semibold text-blue-600 dark:text-blue-400">${exp.name}</h4> <p class="text-xs text-slate-400 dark:text-slate-500 mt-0.5">ID: ${exp.id}</p> </div> <span${addAttribute(`px-3 py-1 text-xs font-medium rounded-full ${exp.is_active ? "bg-green-100 text-green-800 dark:bg-green-700/30 dark:text-green-300" : "bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300"}`, "class")}> ${exp.is_active ? "Active" : "Inactive"} </span> </div> <p class="text-sm text-slate-600 dark:text-slate-300 mb-3">${exp.description || "No description provided."}</p> </div>  <div${addAttribute(`experiment-edit-form-section-${exp.id} hidden`, "class")}> <h4 class="text-xl font-semibold text-slate-700 dark:text-slate-200 mb-4">Edit Experiment: <span class="italic">${exp.name}</span></h4> <form method="POST"${addAttribute(Astro2.url.pathname, "action")} class="space-y-4"> <input type="hidden" name="_action" value="update_experiment"> <input type="hidden" name="experiment_id"${addAttribute(exp.id, "value")}> <div> <label${addAttribute(`edit_experiment_name-${exp.id}`, "for")} class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">
Experiment Name <span class="text-red-500">*</span> </label> <input type="text"${addAttribute(`edit_experiment_name-${exp.id}`, "id")} name="experiment_name" required${addAttribute(exp.name, "value")} class="shadow-sm appearance-none border border-slate-300 dark:border-slate-600 rounded-md w-full py-2.5 px-3 text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-slate-400 dark:placeholder-slate-500"> </div> <div> <label${addAttribute(`edit_experiment_description-${exp.id}`, "for")} class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">
Description (Optional)
</label> <textarea${addAttribute(`edit_experiment_description-${exp.id}`, "id")} name="experiment_description" rows="3" class="shadow-sm appearance-none border border-slate-300 dark:border-slate-600 rounded-md w-full py-2.5 px-3 text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-slate-400 dark:placeholder-slate-500">${exp.description}</textarea> </div> <div class="flex items-center"> <input${addAttribute(`edit_experiment_is_active-${exp.id}`, "id")} name="experiment_is_active" type="checkbox"${addAttribute(exp.is_active, "checked")} class="h-4 w-4 text-blue-600 border-slate-300 dark:border-slate-600 rounded focus:ring-blue-500 bg-white dark:bg-slate-700 dark:checked:bg-blue-500"> <label${addAttribute(`edit_experiment_is_active-${exp.id}`, "for")} class="ml-2 block text-sm text-slate-700 dark:text-slate-300">
Activate this experiment
</label> </div> <div class="flex justify-end space-x-3"> <button type="button" class="cancel-edit-experiment-btn text-sm bg-slate-500 hover:bg-slate-600 text-white font-medium py-2 px-4 rounded-md shadow-sm transition duration-150"${addAttribute(exp.id, "data-experiment-id")}>
Cancel
</button> <button type="submit" class="text-sm bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-md shadow-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900 transition duration-150 ease-in-out">
Save Changes
</button> </div> </form> </div>  <div${addAttribute(`experiment-actions-section-${exp.id}`, "class")}> <div class="mt-4 pt-4 border-t border-dashed border-slate-300 dark:border-slate-600"> <h5 class="text-sm font-semibold text-slate-700 dark:text-slate-200 mb-1">Current Variants (${exp.variants?.length || 0}):</h5> ${exp.variants && exp.variants.length > 0 ? renderTemplate`<ul class="list-disc list-inside pl-1 space-y-0.5 text-sm text-slate-500 dark:text-slate-400"> ${exp.variants.map((variant) => renderTemplate`<li> ${variant.name} <span class="text-xs text-slate-400">(ID: ${variant.id})</span> ${typeof variant.impressions_count === "number" && renderTemplate`<span class="text-xs text-slate-400 ml-2">
(Imp: ${variant.impressions_count}, Conv: ${variant.conversions_count ?? 0}, Rate: ${variant.conversion_rate?.toFixed(1) ?? "N/A"}%)
</span>`} </li>`)} </ul>` : renderTemplate`<p class="text-sm text-slate-500 dark:text-slate-400 italic">No variants defined for this experiment yet.</p>`} </div>  <div class="mt-6 pt-6 border-t border-dashed border-slate-300 dark:border-slate-600"> <h5 class="text-lg font-semibold text-slate-700 dark:text-slate-200 mb-4 text-center">ðŸ“Š Analytics Dashboard</h5>  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">  <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-4 rounded-lg border border-blue-200 dark:border-blue-700"> <h6 class="text-sm font-semibold text-blue-800 dark:text-blue-300 mb-2 flex items-center"> <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"> <path d="M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z"></path> <path d="M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z"></path> </svg>
Performance Overview
</h6> <div class="space-y-1 text-xs"> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Total Impressions:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="total-impressions">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Total Conversions:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="total-conversions">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Overall Rate:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="overall-rate">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Avg. Time on Page:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="avg-time-on-page">Loading...</span> </div> </div> </div>  <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-4 rounded-lg border border-green-200 dark:border-green-700"> <h6 class="text-sm font-semibold text-green-800 dark:text-green-300 mb-2 flex items-center"> <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"> <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path> </svg>
Geographic Insights
</h6> <div class="space-y-1 text-xs"> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Top Country:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="top-country">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Countries:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="country-count">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Best Converting:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="best-country">Loading...</span> </div> </div> </div>  <div class="bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 p-4 rounded-lg border border-purple-200 dark:border-purple-700"> <h6 class="text-sm font-semibold text-purple-800 dark:text-purple-300 mb-2 flex items-center"> <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"> <path fill-rule="evenodd" d="M3 5a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2h-2.22l.123.489.804.804A1 1 0 0113 18H7a1 1 0 01-.707-1.707l.804-.804L7.22 15H5a2 2 0 01-2-2V5zm5.771 7H5V5h10v7H8.771z" clip-rule="evenodd"></path> </svg>
Device & Browser
</h6> <div class="space-y-1 text-xs"> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Top Device:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="top-device">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Top Browser:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="top-browser">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Mobile %:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="mobile-percentage">Loading...</span> </div> </div> </div>  <div class="bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 p-4 rounded-lg border border-orange-200 dark:border-orange-700"> <h6 class="text-sm font-semibold text-orange-800 dark:text-orange-300 mb-2 flex items-center"> <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"> <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path> </svg>
Engagement
</h6> <div class="space-y-1 text-xs"> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Avg. Scroll:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="avg-scroll">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Bounce Rate:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="bounce-rate">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Return Visitors:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="return-visitors">Loading...</span> </div> </div> </div>  <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-900/20 dark:to-indigo-800/20 p-4 rounded-lg border border-indigo-200 dark:border-indigo-700"> <h6 class="text-sm font-semibold text-indigo-800 dark:text-indigo-300 mb-2 flex items-center"> <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"> <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z" clip-rule="evenodd"></path> </svg>
Campaign Tracking
</h6> <div class="space-y-1 text-xs"> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Top Source:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="top-utm-source">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Top Campaign:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="top-utm-campaign">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Direct Traffic:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="direct-traffic">Loading...</span> </div> </div> </div>  <div class="bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 p-4 rounded-lg border border-red-200 dark:border-red-700"> <h6 class="text-sm font-semibold text-red-800 dark:text-red-300 mb-2 flex items-center"> <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"> <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V4a2 2 0 00-2-2H6zm1 2a1 1 0 000 2h6a1 1 0 100-2H7zm6 7a1 1 0 011 1v3a1 1 0 11-2 0v-3a1 1 0 011-1zm-3 3a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zm-4-1a1 1 0 011 1v3a1 1 0 11-2 0v-3a1 1 0 011-1z" clip-rule="evenodd"></path> </svg>
Statistical Significance
</h6> <div class="space-y-1 text-xs"> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Confidence:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="confidence-level">95%</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Sample Size:</span> <span class="font-medium text-slate-800 dark:text-slate-200"${addAttribute(exp.id, "data-experiment-id")} data-metric="sample-size">Loading...</span> </div> <div class="flex justify-between"> <span class="text-slate-600 dark:text-slate-400">Status:</span> <span class="font-medium"${addAttribute(exp.id, "data-experiment-id")} data-metric="significance-status">Loading...</span> </div> </div> </div> </div> </div>  ${exp.variants && exp.variants.filter((v) => typeof v.conversion_rate === "number").length > 0 ? renderTemplate`<div class="mt-6 pt-6 border-t border-dashed border-slate-300 dark:border-slate-600"> <h5 class="text-lg font-semibold text-slate-700 dark:text-slate-200 mb-3 text-center">Variant Conversion Rates</h5> <div class="chart-container relative mx-auto" style="max-width: 350px; height: 350px;"${addAttribute(exp.id, "data-experiment-id")}${addAttribute(exp.variantsJsonString, "data-variants")}> <canvas${addAttribute(`chart-${exp.id}`, "id")}></canvas> </div> </div>` : renderTemplate`<div class="mt-6 pt-6 border-t border-dashed border-slate-300 dark:border-slate-600"> <h5 class="text-lg font-semibold text-slate-700 dark:text-slate-200 mb-3 text-center">Variant Conversion Rates</h5> <p class="text-sm text-slate-400 dark:text-slate-500 text-center italic">No conversion data available to display chart.</p> </div>`} <div class="flex items-center justify-end space-x-3 mt-6 pt-4 border-t border-slate-200 dark:border-slate-700"> <button type="button" class="text-sm bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-2 px-4 rounded-md shadow-sm transition duration-150 edit-experiment-btn"${addAttribute(exp.id, "data-experiment-id")}>Edit Details</button> <button type="button" class="text-sm bg-purple-500 hover:bg-purple-600 text-white font-medium py-2 px-4 rounded-md shadow-sm transition duration-150 manage-variants-btn"${addAttribute(exp.id, "data-experiment-id")}${addAttribute(exp.managingVariants ? "true" : "false", "aria-expanded")}${addAttribute(`manage-variants-section-${exp.id}`, "aria-controls")}> ${exp.managingVariants ? "Hide Variants" : "Manage Variants"} </button> <form method="POST"${addAttribute(Astro2.url.pathname, "action")} class="inline-block delete-experiment-form"${addAttribute(exp.name, "data-experiment-name")}> <input type="hidden" name="_action" value="delete_experiment"> <input type="hidden" name="experiment_id"${addAttribute(exp.id, "value")}> <button type="submit" class="text-sm bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-4 rounded-md shadow-sm transition duration-150 delete-experiment-btn-submit">
Delete Exp.
</button> </form> </div> </div>  <div${addAttribute(`manage-variants-section-${exp.id}`, "id")}${addAttribute(`mt-6 pt-6 border-t border-dashed border-slate-300 dark:border-slate-600 ${!exp.managingVariants ? "hidden" : ""}`, "class")}> <h4 class="text-lg font-semibold text-slate-700 dark:text-slate-200 mb-4">Manage Variants for: <span class="italic">${exp.name}</span></h4>  ${exp.variants && exp.variants.length > 0 ? renderTemplate`<div class="mb-6"> <h5 class="text-md font-medium text-slate-600 dark:text-slate-300 mb-2">Existing Variants:</h5> <ul class="space-y-3"> ${exp.variants.map((variant) => renderTemplate`<li${addAttribute(variant.id, "data-variant-id")} class="variant-item p-3 bg-slate-50 dark:bg-slate-700/50 rounded-md shadow-sm">  <div class="variant-display-section"> <div class="flex justify-between items-start"> <div> <p class="font-semibold text-slate-700 dark:text-slate-200">${variant.name}</p> <p class="text-xs text-slate-400 dark:text-slate-500 mt-0.5">ID: ${variant.id}</p> <p class="text-sm text-slate-500 dark:text-slate-400 mt-1">${variant.description || "No description"}</p> </div> <div class="variant-stats text-xs text-slate-500 dark:text-slate-400 text-right"> <p>Impressions: ${variant.impressions_count ?? 0}</p> <p>Conversions: ${variant.conversions_count ?? 0}</p> <p>Rate: ${variant.conversion_rate?.toFixed(1) ?? "N/A"}%</p> </div> </div> ${variant.config_json && renderTemplate`<details class="mt-2"> <summary class="text-xs text-blue-500 dark:text-blue-400 cursor-pointer hover:underline">Show/Hide Config JSON</summary> <pre class="mt-1 text-xs p-2 bg-slate-100 dark:bg-slate-600 rounded overflow-x-auto whitespace-pre-wrap break-all">${JSON.stringify(variant.config_json, null, 2)}</pre> </details>`} <div class="mt-3 pt-3 border-t border-slate-200 dark:border-slate-600 flex justify-end space-x-2"> <button type="button" class="edit-variant-btn text-xs bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-1 px-3 rounded-md shadow-sm transition duration-150"${addAttribute(exp.id, "data-experiment-id")}${addAttribute(variant.id, "data-variant-id")}>
Edit
</button> <form method="POST"${addAttribute(Astro2.url.pathname, "action")} class="inline-block delete-variant-form"${addAttribute(variant.name, "data-variant-name")}> <input type="hidden" name="_action" value="delete_variant"> <input type="hidden" name="experiment_id"${addAttribute(exp.id, "value")}> <input type="hidden" name="variant_id"${addAttribute(variant.id, "value")}> <button type="submit" class="delete-variant-btn-submit text-xs bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-md shadow-sm transition duration-150">
Delete
</button> </form> </div> </div>  <div class="variant-edit-form-section hidden mt-2"> <h6 class="text-sm font-semibold text-slate-600 dark:text-slate-300 mb-2">Editing Variant: <span class="italic">${variant.name}</span></h6> <form method="POST"${addAttribute(Astro2.url.pathname, "action")} class="space-y-3"> <input type="hidden" name="_action" value="update_variant"> <input type="hidden" name="experiment_id"${addAttribute(exp.id, "value")}> <input type="hidden" name="variant_id"${addAttribute(variant.id, "value")}> <div> <label${addAttribute(`edit_variant_name-${variant.id}`, "for")} class="block text-xs font-medium text-slate-700 dark:text-slate-300 mb-0.5">Variant Name <span class="text-red-500">*</span></label> <input type="text" name="variant_name"${addAttribute(`edit_variant_name-${variant.id}`, "id")} required${addAttribute(variant.name, "value")} class="w-full p-1.5 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-slate-700 dark:text-white"> </div> <div> <label${addAttribute(`edit_variant_description-${variant.id}`, "for")} class="block text-xs font-medium text-slate-700 dark:text-slate-300 mb-0.5">Variant Description</label> <textarea name="variant_description"${addAttribute(`edit_variant_description-${variant.id}`, "id")} rows="2" class="w-full p-1.5 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-slate-700 dark:text-white">${variant.description}</textarea> </div> <div> <label${addAttribute(`edit_variant_config_json-${variant.id}`, "for")} class="block text-xs font-medium text-slate-700 dark:text-slate-300 mb-0.5">Variant Configuration (JSON)</label> <textarea name="variant_config_json"${addAttribute(`edit_variant_config_json-${variant.id}`, "id")} rows="3" class="w-full p-1.5 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm font-mono text-xs focus:ring-blue-500 focus:border-blue-500 dark:bg-slate-700 dark:text-white" placeholder="{
  &quot;headline&quot;: &quot;New Headline!&quot;,
  &quot;buttonColor&quot;: &quot;blue&quot;
}">${JSON.stringify(variant.config_json, null, 2)}</textarea> <p class="text-xs text-slate-500 dark:text-slate-400 mt-0.5">Enter valid JSON. <strong class="text-orange-500">Cannot be changed if variant has impressions.</strong></p> </div> <div class="flex justify-end space-x-2 pt-2"> <button type="button" class="cancel-edit-variant-btn text-xs bg-slate-500 hover:bg-slate-600 text-white font-medium py-1.5 px-3 rounded-md shadow-sm transition duration-150"${addAttribute(variant.id, "data-variant-id")}>
Cancel
</button> <button type="submit" class="save-variant-btn text-xs bg-green-600 hover:bg-green-700 text-white font-semibold py-1.5 px-3 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500">
Save Changes
</button> </div> </form> </div> </li>`)} </ul> </div>` : renderTemplate`<p class="text-sm text-slate-500 dark:text-slate-400 italic mb-4">No variants currently exist for this experiment.</p>`} <h5 class="text-md font-medium text-slate-600 dark:text-slate-300 mb-3 pt-4 border-t border-slate-200 dark:border-slate-700">Add New Variant</h5> <form method="POST"${addAttribute(Astro2.url.pathname, "action")} class="space-y-4 p-4 bg-slate-50 dark:bg-slate-800/30 rounded-lg shadow"> <input type="hidden" name="_action" value="create_variant"> <input type="hidden" name="experiment_id"${addAttribute(exp.id, "value")}> <div> <label${addAttribute(`variant_name-${exp.id}`, "for")} class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Variant Name <span class="text-red-500">*</span></label> <input type="text" name="variant_name"${addAttribute(`variant_name-${exp.id}`, "id")} required class="w-full p-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-slate-700 dark:text-white" placeholder="e.g., Control, Variation A"> </div> <div> <label${addAttribute(`variant_description-${exp.id}`, "for")} class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Variant Description</label> <textarea name="variant_description"${addAttribute(`variant_description-${exp.id}`, "id")} rows="2" class="w-full p-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-slate-700 dark:text-white" placeholder="Brief description of this variant"></textarea> </div> <div> <label${addAttribute(`variant_config_json-${exp.id}`, "for")} class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Variant Configuration (JSON)</label> <textarea name="variant_config_json"${addAttribute(`variant_config_json-${exp.id}`, "id")} rows="3" class="w-full p-2 border border-slate-300 dark:border-slate-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 font-mono text-sm dark:bg-slate-700 dark:text-white" placeholder="{
  &quot;headline&quot;: &quot;New Headline!&quot;,
  &quot;buttonColor&quot;: &quot;blue&quot;
}"></textarea> <p class="text-xs text-slate-500 dark:text-slate-400 mt-1">Enter valid JSON or leave blank.</p> </div> <div class="flex justify-end"> <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-md shadow-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900">Add Variant</button> </div> </form> </div> </div>`)} </div>` : !abTestError && experiments && experiments.length === 0 && renderTemplate`<div class="text-center py-8 px-4 bg-white dark:bg-slate-800 rounded-lg shadow-md"> <svg class="mx-auto h-10 w-10 text-slate-400 dark:text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"> <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75"></path> </svg> <h3 class="mt-2 text-md font-medium text-slate-700 dark:text-slate-200">No Experiments Found</h3> <p class="mt-1 text-sm text-slate-500 dark:text-slate-400">Get started by creating your first A/B experiment using the form above.</p> </div>`} </section> <!-- Modern Confirmation Modal --> <div id="delete-confirmation-modal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true"> <!-- Background overlay --> <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"> <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div> <!-- This element is to trick the browser into centering the modal contents. --> <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span> <!-- Modal panel --> <div class="relative inline-block align-bottom bg-white dark:bg-slate-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6"> <div class="sm:flex sm:items-start"> <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/30 sm:mx-0 sm:h-10 sm:w-10"> <!-- Heroicon name: outline/exclamation-triangle --> <svg class="h-6 w-6 text-red-600 dark:text-red-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path> </svg> </div> <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"> <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" id="modal-title">
Delete Experiment
</h3> <div class="mt-2"> <p class="text-sm text-gray-500 dark:text-gray-300" id="modal-description">
Are you sure you want to delete this experiment? This action will permanently remove the experiment and all its associated variants, impressions, and conversion data. This action cannot be undone.
</p> </div> </div> </div> <div class="mt-5 sm:mt-4 sm:flex sm:flex-row-reverse"> <button type="button" id="confirm-delete-btn" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:focus:ring-offset-slate-800 sm:ml-3 sm:w-auto sm:text-sm transition duration-150 ease-in-out">
Delete Experiment
</button> <button type="button" id="cancel-delete-btn" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-slate-700 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-slate-800 sm:mt-0 sm:w-auto sm:text-sm transition duration-150 ease-in-out">
Cancel
</button> </div> </div> </div> </div> <!-- Modern Confirmation Modal for Variants --> <div id="delete-variant-confirmation-modal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="variant-modal-title" role="dialog" aria-modal="true"> <!-- Background overlay --> <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"> <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div> <!-- This element is to trick the browser into centering the modal contents. --> <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span> <!-- Modal panel --> <div class="relative inline-block align-bottom bg-white dark:bg-slate-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6"> <div class="sm:flex sm:items-start"> <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/30 sm:mx-0 sm:h-10 sm:w-10"> <!-- Heroicon name: outline/exclamation-triangle --> <svg class="h-6 w-6 text-red-600 dark:text-red-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true"> <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path> </svg> </div> <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"> <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" id="variant-modal-title">
Delete Variant
</h3> <div class="mt-2"> <p class="text-sm text-gray-500 dark:text-gray-300" id="variant-modal-description">
Are you sure you want to delete this variant? This action cannot be undone, especially if the variant has impressions.
</p> </div> </div> </div> <div class="mt-5 sm:mt-4 sm:flex sm:flex-row-reverse"> <button type="button" id="confirm-delete-variant-btn" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:focus:ring-offset-slate-800 sm:ml-3 sm:w-auto sm:text-sm transition duration-150 ease-in-out">
Delete Variant
</button> <button type="button" id="cancel-delete-variant-btn" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-slate-700 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-slate-800 sm:mt-0 sm:w-auto sm:text-sm transition duration-150 ease-in-out">
Cancel
</button> </div> </div> </div> </div> ${renderScript($$result, "C:/Dev/jason_personal_website/src/components/widgets/ABTestManager.astro?astro&type=script&index=0&lang.ts")}`;
}, "C:/Dev/jason_personal_website/src/components/widgets/ABTestManager.astro", void 0);

const $$Astro = createAstro("https://astrowind.vercel.app");
const $$Dashboard = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Dashboard;
  const metadata = {
    title: "Admin Dashboard",
    // Updated title
    description: "Manage A/B Tests and view user profiles."
    // Updated description
  };
  let _userProfiles = null;
  let pageError = null;
  let session = null;
  let experiments = null;
  let abTestError = null;
  let generalMessage = null;
  async function fetchExperimentsWithStats(openExperimentIdFromUrl) {
    const { data: experimentsData, error: experimentsError } = await supabase.from("experiments").select(`
      id,
      name,
      description,
      is_active,
      created_at,
      updated_at,
      variants (id, name, description, config_json, created_at, updated_at)
    `).order("created_at", { ascending: false });
    if (experimentsError) {
      console.error("Supabase fetch experiments error:", experimentsError);
      throw new Error(experimentsError.message || "Failed to fetch experiments.");
    }
    if (!experimentsData) return [];
    const experimentsWithStats = await Promise.all(experimentsData.map(async (exp) => {
      let variantsWithStats = [];
      const currentVariants = exp.variants || [];
      if (currentVariants.length > 0) {
        variantsWithStats = await Promise.all(currentVariants.map(async (variant) => {
          const { count: impressionsCount, error: impressionsError } = await supabase.from("impressions").select("*", { count: "exact", head: true }).eq("variant_id", variant.id);
          const { count: conversionsCount, error: conversionsError } = await supabase.from("conversions").select("*", { count: "exact", head: true }).eq("variant_id", variant.id);
          if (impressionsError) console.error(`Error fetching impressions for variant ${variant.id}:`, impressionsError);
          if (conversionsError) console.error(`Error fetching conversions for variant ${variant.id}:`, conversionsError);
          const impressions = impressionsCount || 0;
          const conversions = conversionsCount || 0;
          const conversion_rate = impressions > 0 ? conversions / impressions * 100 : 0;
          return {
            ...variant,
            impressions_count: impressions,
            conversions_count: conversions,
            conversion_rate
          };
        }));
      }
      return {
        ...exp,
        variants: variantsWithStats.sort((a, b) => new Date(a.created_at).getTime() - new Date(b.created_at).getTime()),
        // Sort variants by creation date
        managingVariants: openExperimentIdFromUrl === exp.id,
        // Set based on URL param
        variantsJsonString: JSON.stringify(variantsWithStats.map((v) => ({
          // Pre-stringify for chart
          name: v.name,
          rate: v.conversion_rate,
          impressions: v.impressions_count,
          conversions: v.conversions_count
        })))
      };
    }));
    return experimentsWithStats;
  }
  if (Astro2.request.method === "POST") {
    const formData = await Astro2.request.formData();
    const action = formData.get("_action")?.toString();
    const { data: { session: freshSessionOnPost } } = await supabase.auth.getSession();
    session = freshSessionOnPost;
    if (action === "login") {
      const email = formData.get("email")?.toString();
      const password = formData.get("password")?.toString();
      if (email && password) {
        const { data, error: loginError } = await supabase.auth.signInWithPassword({
          email,
          password
        });
        if (loginError) {
          pageError = loginError.message;
        } else if (data.session) {
          session = data.session;
          Astro2.cookies.set("auth_message", "Login successful!", { path: "/", maxAge: 5 });
          return Astro2.redirect(Astro2.url.pathname + "#user-profiles-panel", 303);
        }
      } else {
        pageError = "Email and password are required.";
      }
    } else if (action === "logout") {
      const { error: logoutError } = await supabase.auth.signOut();
      if (logoutError) {
        pageError = logoutError.message;
      } else {
        session = null;
        Astro2.cookies.set("auth_message", "Logout successful!", { path: "/", maxAge: 5 });
        return Astro2.redirect(Astro2.url.pathname, 303);
      }
    } else if (action?.startsWith("create_") || action?.startsWith("update_") || action?.startsWith("delete_")) {
      if (!session) {
        abTestError = "Authentication required. Please log in again to manage A/B tests.";
      } else {
        try {
          if (action === "create_experiment") {
            const name = formData.get("experiment_name")?.toString();
            const description = formData.get("experiment_description")?.toString();
            const is_active = formData.get("experiment_is_active") === "on";
            if (!name || name.trim() === "") throw new Error("Experiment name is required.");
            const { error: createExpError } = await supabase.from("experiments").insert([{ name, description, is_active }]);
            if (createExpError) throw createExpError;
            return Astro2.redirect(Astro2.url.pathname + "#ab-testing-panel", 303);
          } else if (action === "create_variant") {
            const experimentId = formData.get("experiment_id")?.toString();
            const name = formData.get("variant_name")?.toString();
            const description = formData.get("variant_description")?.toString();
            const configJsonString = formData.get("variant_config_json")?.toString();
            if (!experimentId || !name || name.trim() === "") throw new Error("Experiment ID and Variant Name are required.");
            let config_json = null;
            if (configJsonString && configJsonString.trim() !== "") {
              try {
                config_json = JSON.parse(configJsonString);
              } catch {
                throw new Error("Invalid JSON for Variant Config.");
              }
            }
            const { error: createVarError } = await supabase.from("variants").insert([{ experiment_id: experimentId, name, description, config_json }]);
            if (createVarError) throw createVarError;
            return Astro2.redirect(Astro2.url.pathname + `?openExperiment=${experimentId}#ab-testing-panel`, 303);
          } else if (action === "update_experiment") {
            const experimentId = formData.get("experiment_id")?.toString();
            const name = formData.get("experiment_name")?.toString();
            const description = formData.get("experiment_description")?.toString();
            const is_active = formData.get("experiment_is_active") === "on";
            if (!experimentId || !name || name.trim() === "") throw new Error("Experiment ID and Name required for update.");
            const { error: updateExpError } = await supabase.from("experiments").update({ name, description, is_active, updated_at: (/* @__PURE__ */ new Date()).toISOString() }).eq("id", experimentId);
            if (updateExpError) throw updateExpError;
            return Astro2.redirect(Astro2.url.pathname + `#experiment-${experimentId}`, 303);
          } else if (action === "update_variant") {
            const experimentId = formData.get("experiment_id")?.toString();
            const variantId = formData.get("variant_id")?.toString();
            const name = formData.get("variant_name")?.toString();
            const description = formData.get("variant_description")?.toString();
            const configJsonString = formData.get("variant_config_json")?.toString();
            if (!variantId || !name || name.trim() === "") throw new Error("Variant ID and Name required for update.");
            const { count: impressionsCount } = await supabase.from("impressions").select("*", { count: "exact", head: true }).eq("variant_id", variantId);
            let newConfigJson = null;
            if (configJsonString && configJsonString.trim() !== "") {
              try {
                newConfigJson = JSON.parse(configJsonString);
              } catch {
                throw new Error("Invalid JSON for Variant Config.");
              }
            }
            if ((impressionsCount || 0) > 0) {
              const { data: existingVariant } = await supabase.from("variants").select("config_json").eq("id", variantId).single();
              if (JSON.stringify(existingVariant?.config_json) !== JSON.stringify(newConfigJson)) {
                throw new Error("Cannot change config of variant with impressions.");
              }
            }
            const { error: updateVarError } = await supabase.from("variants").update({ name, description, config_json: newConfigJson, updated_at: (/* @__PURE__ */ new Date()).toISOString() }).eq("id", variantId);
            if (updateVarError) throw updateVarError;
            return Astro2.redirect(Astro2.url.pathname + `?openExperiment=${experimentId}#ab-testing-panel`, 303);
          } else if (action === "delete_experiment") {
            const experimentId = formData.get("experiment_id")?.toString();
            if (!experimentId) throw new Error("Experiment ID is required for deletion.");
            const { error: deleteExpError } = await supabase.from("experiments").delete().eq("id", experimentId);
            if (deleteExpError) {
              console.error("Error deleting experiment:", deleteExpError);
              throw new Error(`Failed to delete experiment: ${deleteExpError.message}`);
            }
            return Astro2.redirect(Astro2.url.pathname + "#ab-testing-panel", 303);
          } else if (action === "delete_variant") {
            const experimentId = formData.get("experiment_id")?.toString();
            const variantId = formData.get("variant_id")?.toString();
            if (!variantId) throw new Error("Variant ID is required for deletion.");
            const { count: impressionsCount } = await supabase.from("impressions").select("*", { count: "exact", head: true }).eq("variant_id", variantId);
            if ((impressionsCount || 0) > 0) throw new Error("Cannot delete variant with existing impressions.");
            const { error: deleteVarError } = await supabase.from("variants").delete().eq("id", variantId);
            if (deleteVarError) throw deleteVarError;
            return Astro2.redirect(Astro2.url.pathname + `?openExperiment=${experimentId}#ab-testing-panel`, 303);
          }
        } catch (e) {
          if (e instanceof Error) {
            abTestError = e.message;
          } else {
            abTestError = "An unexpected error occurred during A/B test action.";
          }
          console.error("A/B Test Action Error:", e);
        }
      }
    }
  }
  if (Astro2.request.method === "GET") {
    const { data: { session: currentSession } } = await supabase.auth.getSession();
    session = currentSession;
    const authMessage = Astro2.cookies.get("auth_message");
    if (authMessage) {
      generalMessage = authMessage.value;
      Astro2.cookies.delete("auth_message", { path: "/" });
    }
    if (session) {
      try {
        const { data, error: profileError } = await supabase.from("user_profiles").select("id, email, created_at, updated_at");
        if (profileError) throw profileError;
        _userProfiles = data;
      } catch (e) {
        if (e instanceof Error) {
          pageError = e.message;
        } else {
          pageError = "Failed to fetch user profiles due to an unexpected error.";
        }
        console.error("Fetch user profiles error:", e);
      }
      try {
        const openExperimentId = new URL(Astro2.request.url).searchParams.get("openExperiment");
        experiments = await fetchExperimentsWithStats(openExperimentId);
      } catch (e) {
        if (e instanceof Error) {
          abTestError = e.message;
        } else {
          abTestError = "Failed to fetch experiments due to an unexpected error.";
        }
        console.error("Fetch experiments error:", e);
      }
    }
  }
  return renderTemplate`${renderComponent($$result, "Layout", $$PageLayout, { "metadata": metadata, "data-astro-cid-3nssi2tu": true }, { "default": async ($$result2) => renderTemplate` ${maybeRenderHead()}<div class="container mx-auto px-4 py-8 max-w-4xl" data-astro-cid-3nssi2tu> <div class="flex justify-between items-center mb-6" data-astro-cid-3nssi2tu> <h1 class="text-3xl font-bold text-slate-800 dark:text-white" data-astro-cid-3nssi2tu>Admin Dashboard</h1> ${session && renderTemplate`<div class="flex items-center" data-astro-cid-3nssi2tu> <p class="text-sm text-slate-600 dark:text-slate-300 mr-3" data-astro-cid-3nssi2tu>
Logged in as: <span class="font-semibold" data-astro-cid-3nssi2tu>${session.user.email}</span> </p> <form method="POST"${addAttribute(Astro2.url.pathname + "#user-profiles-panel", "action")} data-astro-cid-3nssi2tu> <input type="hidden" name="_action" value="logout" data-astro-cid-3nssi2tu> <button type="submit" class="px-4 py-2 text-sm font-medium tracking-wide text-white capitalize transition-colors duration-200 transform bg-red-500 rounded-md hover:bg-red-600 focus:outline-none focus:ring focus:ring-red-300 focus:ring-opacity-80" data-astro-cid-3nssi2tu>
Logout
</button> </form> </div>`} </div>  ${pageError && renderTemplate`<div class="mb-6 p-4 bg-red-100 dark:bg-red-800/30 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-300 rounded-lg shadow-sm" role="alert" data-astro-cid-3nssi2tu> <p class="font-bold text-lg" data-astro-cid-3nssi2tu>Error:</p> <p data-astro-cid-3nssi2tu>${pageError}</p> </div>`}  ${generalMessage && renderTemplate`<div class="mb-6 p-4 bg-green-100 dark:bg-green-800/30 border border-green-400 dark:border-green-600 text-green-700 dark:text-green-300 rounded-lg shadow-sm" role="alert" data-astro-cid-3nssi2tu> <p data-astro-cid-3nssi2tu>${generalMessage}</p> </div>`}  ${session && renderTemplate`<div class="mb-8" data-astro-cid-3nssi2tu> <div class="sm:hidden" data-astro-cid-3nssi2tu> <label for="tabs" class="sr-only" data-astro-cid-3nssi2tu>Select a tab</label> <select id="tabs" name="tabs" class="block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 dark:bg-slate-700 dark:border-slate-600 dark:text-white" data-astro-cid-3nssi2tu> <option data-astro-cid-3nssi2tu>Analytics</option> <option data-astro-cid-3nssi2tu>Campaign Performance</option> <option selected data-astro-cid-3nssi2tu>A/B Testing</option> <option data-astro-cid-3nssi2tu>User Journey</option> </select> </div> <div class="hidden sm:block" data-astro-cid-3nssi2tu> <div class="border-b border-slate-200 dark:border-slate-700" data-astro-cid-3nssi2tu> <nav class="-mb-px flex space-x-4" aria-label="Tabs" data-astro-cid-3nssi2tu> <a href="#analytics-panel" id="analytics-tab" class="tab-button group whitespace-nowrap py-3 px-3 border-b-2 font-medium text-sm flex items-center" aria-current="false" data-astro-cid-3nssi2tu> <svg class="-ml-0.5 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-astro-cid-3nssi2tu><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" data-astro-cid-3nssi2tu></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" data-astro-cid-3nssi2tu></path></svg> <span data-astro-cid-3nssi2tu>Analytics</span> </a> <a href="#campaign-performance-panel" id="campaign-performance-tab" class="tab-button group whitespace-nowrap py-3 px-3 border-b-2 font-medium text-sm flex items-center" aria-current="false" data-astro-cid-3nssi2tu> <svg class="-ml-0.5 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-astro-cid-3nssi2tu><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" data-astro-cid-3nssi2tu></path></svg> <span data-astro-cid-3nssi2tu>Campaign Performance</span> </a> <a href="#ab-testing-panel" id="ab-testing-tab" class="tab-button group whitespace-nowrap py-3 px-3 border-b-2 font-medium text-sm flex items-center" aria-current="false" data-astro-cid-3nssi2tu> <svg class="-ml-0.5 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-astro-cid-3nssi2tu><path fill-rule="evenodd" d="M7.5 5a2.5 2.5 0 00-4.995.088A2.5 2.5 0 002.5 7.5v5A2.5 2.5 0 005 15h10a2.5 2.5 0 002.5-2.5v-5A2.5 2.5 0 0015 5H7.5zM5 7.5a.5.5 0 01.5-.5h1.086A.5.5 0 017 7.5v5a.5.5 0 01-.5.5H5.5a.5.5 0 01-.5-.5v-5zm9.5 0a.5.5 0 00-.5-.5H13A.5.5 0 0012.5 7.5v5a.5.5 0 00.5.5h1.086A.5.5 0 00.414-.75L13.5 9.5l1.414-2.75A.5.5 0 0014.5 7.5z" clip-rule="evenodd" data-astro-cid-3nssi2tu></path></svg> <span data-astro-cid-3nssi2tu>A/B Testing</span> </a> <a href="#user-journey-panel" id="user-journey-tab" class="tab-button group whitespace-nowrap py-3 px-3 border-b-2 font-medium text-sm flex items-center" aria-current="false" data-astro-cid-3nssi2tu> <svg class="-ml-0.5 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-astro-cid-3nssi2tu><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.293l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd" data-astro-cid-3nssi2tu></path></svg> <span data-astro-cid-3nssi2tu>User Journey</span> </a> </nav> </div> </div> </div>`}  ${!session ? (
    /* Show login form when not authenticated */
    renderTemplate`<div class="max-w-md mx-auto mt-12 bg-white dark:bg-slate-800 shadow-xl rounded-lg p-8" data-astro-cid-3nssi2tu> <h3 class="text-2xl font-semibold text-center text-slate-700 dark:text-slate-200 mb-6" data-astro-cid-3nssi2tu>Admin Login Required</h3> <p class="text-center text-slate-600 dark:text-slate-400 mb-6" data-astro-cid-3nssi2tu>
Please log in to access the admin dashboard and manage A/B tests.
</p> <form method="POST"${addAttribute(Astro2.url.pathname, "action")} class="space-y-6" data-astro-cid-3nssi2tu> <input type="hidden" name="_action" value="login" data-astro-cid-3nssi2tu> <div data-astro-cid-3nssi2tu> <label for="email" class="block text-sm font-medium text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Email Address</label> <input id="email" name="email" type="email" autocomplete="email" required class="mt-1 block w-full shadow-sm appearance-none border border-slate-300 dark:border-slate-600 rounded-md py-2.5 px-3 text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-slate-400 dark:placeholder-slate-500" data-astro-cid-3nssi2tu> </div> <div data-astro-cid-3nssi2tu> <label for="password" class="block text-sm font-medium text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Password</label> <input id="password" name="password" type="password" autocomplete="current-password" required class="mt-1 block w-full shadow-sm appearance-none border border-slate-300 dark:border-slate-600 rounded-md py-2.5 px-3 text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-slate-400 dark:placeholder-slate-500" data-astro-cid-3nssi2tu> </div> <button type="submit" class="w-full flex justify-center py-2.5 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-slate-900 focus:ring-blue-500 transition duration-150 ease-in-out" data-astro-cid-3nssi2tu>
Sign In
</button> </form> </div>`
  ) : (
    /* Show admin dashboard when authenticated */
    renderTemplate`${renderComponent($$result2, "Fragment", Fragment, { "data-astro-cid-3nssi2tu": true }, { "default": async ($$result3) => renderTemplate`<div id="analytics-panel" role="tabpanel" class="tab-panel pt-6 hidden" data-astro-cid-3nssi2tu> <div class="mb-6" data-astro-cid-3nssi2tu> <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-2" data-astro-cid-3nssi2tu>Analytics Overview</h2> <p class="text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Comprehensive insights into your A/B testing performance and user engagement.</p> </div> <div id="analytics-loading" class="text-center py-8" data-astro-cid-3nssi2tu> <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600" data-astro-cid-3nssi2tu></div> <p class="mt-2 text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Loading analytics data...</p> </div> <div id="analytics-error" class="hidden mb-6 p-4 bg-red-100 dark:bg-red-800/30 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-300 rounded-lg" data-astro-cid-3nssi2tu> <p class="font-bold" data-astro-cid-3nssi2tu>Error loading analytics:</p> <p id="analytics-error-message" data-astro-cid-3nssi2tu></p> </div> <div id="analytics-content" class="hidden space-y-6" data-astro-cid-3nssi2tu> <!-- Performance Overview Card --> <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white shadow-lg" data-astro-cid-3nssi2tu> <div class="flex items-center justify-between mb-4" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold" data-astro-cid-3nssi2tu>Performance Overview</h3> <svg class="w-6 h-6 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-3nssi2tu> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" data-astro-cid-3nssi2tu></path> </svg> </div> <div class="space-y-2" data-astro-cid-3nssi2tu> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Total Impressions:</span> <span id="total-impressions" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Total Conversions:</span> <span id="total-conversions" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Conversion Rate:</span> <span id="conversion-rate" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Avg. Time on Page:</span> <span id="avg-time-on-page" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> </div> </div> <!-- Geographic Insights Card --> <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white shadow-lg" data-astro-cid-3nssi2tu> <div class="flex items-center justify-between mb-4" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold" data-astro-cid-3nssi2tu>Geographic Insights</h3> <svg class="w-6 h-6 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-3nssi2tu> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-astro-cid-3nssi2tu></path> </svg> </div> <div class="space-y-2" data-astro-cid-3nssi2tu> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Top Country:</span> <span id="top-country" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Country Count:</span> <span id="country-count" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Best Converting:</span> <span id="best-converting-country" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Best Rate:</span> <span id="best-converting-rate" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> </div> </div> <!-- Device & Browser Card --> <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white shadow-lg" data-astro-cid-3nssi2tu> <div class="flex items-center justify-between mb-4" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold" data-astro-cid-3nssi2tu>Device & Browser</h3> <svg class="w-6 h-6 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-3nssi2tu> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" data-astro-cid-3nssi2tu></path> </svg> </div> <div class="space-y-2" data-astro-cid-3nssi2tu> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Top Device:</span> <span id="top-device" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Top Browser:</span> <span id="top-browser" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Mobile %:</span> <span id="mobile-percentage" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Platform Diversity:</span> <span id="platform-diversity" class="font-bold text-blue-200" data-astro-cid-3nssi2tu>Good</span> </div> </div> </div> <!-- Engagement Metrics Card --> <div class="bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-6 text-white shadow-lg" data-astro-cid-3nssi2tu> <div class="flex items-center justify-between mb-4" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold" data-astro-cid-3nssi2tu>Engagement Metrics</h3> <svg class="w-6 h-6 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-3nssi2tu> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" data-astro-cid-3nssi2tu></path> </svg> </div> <div class="space-y-2" data-astro-cid-3nssi2tu> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Avg. Scroll Depth:</span> <span id="avg-scroll-depth" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Bounce Rate:</span> <span id="bounce-rate" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Return Visitors:</span> <span id="return-visitors" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Engagement Score:</span> <span id="engagement-score" class="font-bold text-yellow-200" data-astro-cid-3nssi2tu>Good</span> </div> </div> </div> <!-- Campaign Tracking Card --> <div class="bg-gradient-to-br from-red-500 to-red-600 rounded-xl p-6 text-white shadow-lg" data-astro-cid-3nssi2tu> <div class="flex items-center justify-between mb-4" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold" data-astro-cid-3nssi2tu>Campaign Tracking</h3> <svg class="w-6 h-6 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-3nssi2tu> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" data-astro-cid-3nssi2tu></path> </svg> </div> <div class="space-y-2" data-astro-cid-3nssi2tu> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Top UTM Source:</span> <span id="top-utm-source" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Top Campaign:</span> <span id="top-utm-campaign" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Direct Traffic:</span> <span id="direct-traffic-percentage" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Channel Mix:</span> <span id="channel-mix" class="font-bold text-pink-200" data-astro-cid-3nssi2tu>Diverse</span> </div> </div> </div> <!-- Statistical Significance Card --> <div class="bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl p-6 text-white shadow-lg" data-astro-cid-3nssi2tu> <div class="flex items-center justify-between mb-4" data-astro-cid-3nssi2tu> <h3 class="text-lg font-semibold" data-astro-cid-3nssi2tu>Statistical Significance</h3> <svg class="w-6 h-6 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-3nssi2tu> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" data-astro-cid-3nssi2tu></path> </svg> </div> <div class="space-y-2" data-astro-cid-3nssi2tu> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Confidence Level:</span> <span id="confidence-level" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Sample Size:</span> <span id="sample-size" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Is Significant:</span> <span id="is-significant" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="opacity-90" data-astro-cid-3nssi2tu>Reliability:</span> <span id="reliability" class="font-bold text-cyan-200" data-astro-cid-3nssi2tu>High</span> </div> </div> </div> </div> <div class="mt-8 text-center" data-astro-cid-3nssi2tu> <button id="refresh-analytics" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900" data-astro-cid-3nssi2tu>
Refresh Analytics
</button> </div> </div> <div id="campaign-performance-panel" role="tabpanel" class="tab-panel pt-6 hidden" data-astro-cid-3nssi2tu> <div class="mb-6" data-astro-cid-3nssi2tu> <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-2" data-astro-cid-3nssi2tu>Campaign Performance</h2> <p class="text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Comprehensive UTM tracking, attribution analysis, ROI metrics, and funnel insights.</p> </div> <div id="campaign-loading" class="text-center py-8" data-astro-cid-3nssi2tu> <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600" data-astro-cid-3nssi2tu></div> <p class="mt-2 text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Loading campaign performance data...</p> </div> <div id="campaign-error" class="hidden mb-6 p-4 bg-red-100 dark:bg-red-800/30 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-300 rounded-lg" data-astro-cid-3nssi2tu> <p class="font-bold" data-astro-cid-3nssi2tu>Error loading campaign data:</p> <p id="campaign-error-message" data-astro-cid-3nssi2tu></p> </div> <div id="campaign-content" class="hidden space-y-8" data-astro-cid-3nssi2tu> <!-- Attribution Summary --> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>Attribution Summary</h3> <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4" data-astro-cid-3nssi2tu> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-blue-600" id="total-attributed-conversions" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Total Attributed</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-gray-600" id="direct-conversions" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Direct</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-green-600" id="organic-conversions" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Organic</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-orange-600" id="paid-conversions" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Paid</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-purple-600" id="social-conversions" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Social</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-red-600" id="email-conversions" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Email</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-indigo-600" id="referral-conversions" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Referral</div> </div> </div> </div> <!-- UTM Sources Performance --> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" data-astro-cid-3nssi2tu> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>Top Traffic Sources</h3> <div id="sources-table" class="space-y-3" data-astro-cid-3nssi2tu> <!-- Dynamic content will be populated here --> </div> </div> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>Top Mediums</h3> <div id="mediums-table" class="space-y-3" data-astro-cid-3nssi2tu> <!-- Dynamic content will be populated here --> </div> </div> </div> <!-- Campaign Funnel Analysis --> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>Campaign Funnel Analysis</h3> <div class="mb-4" data-astro-cid-3nssi2tu> <div class="flex justify-between text-sm text-slate-600 dark:text-slate-400 mb-2" data-astro-cid-3nssi2tu> <span data-astro-cid-3nssi2tu>Overall Conversion Rate: <span id="overall-funnel-rate" class="font-semibold" data-astro-cid-3nssi2tu>-</span></span> <span data-astro-cid-3nssi2tu>Biggest Drop-off: <span id="biggest-dropoff" class="font-semibold" data-astro-cid-3nssi2tu>-</span></span> </div> </div> <div id="funnel-stages" class="grid grid-cols-1 md:grid-cols-4 gap-4" data-astro-cid-3nssi2tu> <!-- Dynamic funnel stages will be populated here --> </div> </div> <!-- Top Campaigns Performance --> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>Top Campaigns</h3> <div class="overflow-x-auto" data-astro-cid-3nssi2tu> <table class="w-full text-sm" data-astro-cid-3nssi2tu> <thead data-astro-cid-3nssi2tu> <tr class="border-b border-slate-200 dark:border-slate-700" data-astro-cid-3nssi2tu> <th class="text-left py-3 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Campaign</th> <th class="text-left py-3 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Source</th> <th class="text-left py-3 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Medium</th> <th class="text-right py-3 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Impressions</th> <th class="text-right py-3 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Conversions</th> <th class="text-right py-3 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Rate</th> <th class="text-right py-3 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>ROI</th> </tr> </thead> <tbody id="campaigns-table" data-astro-cid-3nssi2tu> <!-- Dynamic content will be populated here --> </tbody> </table> </div> </div> <!-- Performance Trends --> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>Performance Trends (Last 30 Days)</h3> <div class="h-64" data-astro-cid-3nssi2tu> <canvas id="campaign-trends-chart" data-astro-cid-3nssi2tu></canvas> </div> </div> </div> <div class="mt-8 text-center" data-astro-cid-3nssi2tu> <button id="refresh-campaign-performance" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900" data-astro-cid-3nssi2tu>
Refresh Campaign Data
</button> </div> </div> <div id="ab-testing-panel" role="tabpanel" class="tab-panel pt-6 hidden" data-astro-cid-3nssi2tu> ${renderComponent($$result3, "ABTestManager", $$ABTestManager, { "experiments": experiments, "abTestError": abTestError, "data-astro-cid-3nssi2tu": true })} </div> <div id="user-journey-panel" role="tabpanel" class="tab-panel pt-6 hidden" data-astro-cid-3nssi2tu> <div class="mb-6" data-astro-cid-3nssi2tu> <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-2" data-astro-cid-3nssi2tu>User Journey Analytics</h2> <p class="text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Comprehensive analysis of user sessions, engagement patterns, bounce rates, and device performance impact.</p> </div> <div id="user-journey-loading" class="text-center py-8" data-astro-cid-3nssi2tu> <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600" data-astro-cid-3nssi2tu></div> <p class="mt-2 text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Loading user journey data...</p> </div> <div id="user-journey-error" class="hidden mb-6 p-4 bg-red-100 dark:bg-red-800/30 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-300 rounded-lg" data-astro-cid-3nssi2tu> <p class="font-bold" data-astro-cid-3nssi2tu>Error loading user journey data:</p> <p id="user-journey-error-message" data-astro-cid-3nssi2tu></p> </div> <div id="user-journey-content" class="hidden space-y-8" data-astro-cid-3nssi2tu> <!-- Session Flow Analysis --> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>Session Flow Analysis</h3> <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6" data-astro-cid-3nssi2tu> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-blue-600" id="session-count" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Total Sessions</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-green-600" id="avg-session-duration" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Avg Duration (s)</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-purple-600" id="avg-pages-per-session" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Pages/Session</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-orange-600" id="returning-user-rate" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Returning Users %</div> </div> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6" data-astro-cid-3nssi2tu> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Top Entry Pages</h4> <div id="entry-pages-list" class="space-y-2" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </div> </div> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Top Exit Pages</h4> <div id="exit-pages-list" class="space-y-2" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </div> </div> </div> </div> <!-- Engagement Metrics --> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>Engagement Metrics</h3> <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6" data-astro-cid-3nssi2tu> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-blue-600" id="avg-time-on-page-journey" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Avg Time on Page (s)</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-green-600" id="avg-scroll-depth-journey" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Avg Scroll Depth %</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-purple-600" id="engagement-rate-journey" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Engagement Rate %</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-orange-600" id="interaction-rate-journey" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Interaction Rate %</div> </div> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-2xl font-bold text-red-600" id="content-consumption-score" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Content Score</div> </div> </div> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Page Engagement Analysis</h4> <div id="page-engagement-list" class="space-y-2" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </div> </div> </div> <!-- Bounce Rate Analysis --> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>Bounce Rate Analysis</h3> <div class="mb-4" data-astro-cid-3nssi2tu> <div class="text-center" data-astro-cid-3nssi2tu> <div class="text-3xl font-bold text-red-600" id="overall-bounce-rate" data-astro-cid-3nssi2tu>-</div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>Overall Bounce Rate</div> </div> </div> <div class="grid grid-cols-1 md:grid-cols-3 gap-6" data-astro-cid-3nssi2tu> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Bounce Rate by Page</h4> <div id="bounce-rate-by-page" class="space-y-2" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </div> </div> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Bounce Rate by Source</h4> <div id="bounce-rate-by-source" class="space-y-2" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </div> </div> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Bounce Rate by Device</h4> <div id="bounce-rate-by-device" class="space-y-2" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </div> </div> </div> </div> <!-- Device & Connection Impact --> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>Device & Connection Impact</h3> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6" data-astro-cid-3nssi2tu> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Performance by Device Type</h4> <div class="overflow-x-auto" data-astro-cid-3nssi2tu> <table class="w-full text-sm" data-astro-cid-3nssi2tu> <thead data-astro-cid-3nssi2tu> <tr class="border-b border-slate-200 dark:border-slate-700" data-astro-cid-3nssi2tu> <th class="text-left py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Device</th> <th class="text-right py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Sessions</th> <th class="text-right py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Load Time</th> <th class="text-right py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Conv %</th> </tr> </thead> <tbody id="device-performance-table" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </tbody> </table> </div> </div> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Connection Type Analysis</h4> <div class="overflow-x-auto" data-astro-cid-3nssi2tu> <table class="w-full text-sm" data-astro-cid-3nssi2tu> <thead data-astro-cid-3nssi2tu> <tr class="border-b border-slate-200 dark:border-slate-700" data-astro-cid-3nssi2tu> <th class="text-left py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Connection</th> <th class="text-right py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Sessions</th> <th class="text-right py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Load Time</th> <th class="text-right py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Engagement</th> </tr> </thead> <tbody id="connection-analysis-table" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </tbody> </table> </div> </div> </div> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Screen Resolution Impact</h4> <div class="overflow-x-auto" data-astro-cid-3nssi2tu> <table class="w-full text-sm" data-astro-cid-3nssi2tu> <thead data-astro-cid-3nssi2tu> <tr class="border-b border-slate-200 dark:border-slate-700" data-astro-cid-3nssi2tu> <th class="text-left py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Resolution</th> <th class="text-right py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Sessions</th> <th class="text-right py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Scroll Depth %</th> <th class="text-right py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Time on Page</th> <th class="text-right py-2 text-slate-700 dark:text-slate-300" data-astro-cid-3nssi2tu>Conv Rate %</th> </tr> </thead> <tbody id="resolution-impact-table" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </tbody> </table> </div> </div> </div> <!-- User Behavior Patterns --> <div class="bg-white dark:bg-slate-800 rounded-xl p-6 shadow-lg" data-astro-cid-3nssi2tu> <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-4" data-astro-cid-3nssi2tu>User Behavior Patterns</h3> <div class="grid grid-cols-1 md:grid-cols-3 gap-6" data-astro-cid-3nssi2tu> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>New vs Returning Users</h4> <div class="space-y-3" data-astro-cid-3nssi2tu> <div class="p-3 bg-slate-50 dark:bg-slate-700 rounded-lg" data-astro-cid-3nssi2tu> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="font-medium" data-astro-cid-3nssi2tu>New Users:</span> <span id="new-users-count" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>
Engagement: <span id="new-users-engagement" data-astro-cid-3nssi2tu>-</span>% | Conv: <span id="new-users-conversion" data-astro-cid-3nssi2tu>-</span>%
</div> </div> <div class="p-3 bg-slate-50 dark:bg-slate-700 rounded-lg" data-astro-cid-3nssi2tu> <div class="flex justify-between" data-astro-cid-3nssi2tu> <span class="font-medium" data-astro-cid-3nssi2tu>Returning Users:</span> <span id="returning-users-count" class="font-bold" data-astro-cid-3nssi2tu>-</span> </div> <div class="text-sm text-slate-600 dark:text-slate-400" data-astro-cid-3nssi2tu>
Engagement: <span id="returning-users-engagement" data-astro-cid-3nssi2tu>-</span>% | Conv: <span id="returning-users-conversion" data-astro-cid-3nssi2tu>-</span>%
</div> </div> </div> </div> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Session Frequency</h4> <div id="session-frequency-list" class="space-y-2" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </div> </div> <div data-astro-cid-3nssi2tu> <h4 class="font-semibold text-slate-700 dark:text-slate-300 mb-3" data-astro-cid-3nssi2tu>Engagement Segments</h4> <div id="engagement-segments-list" class="space-y-2" data-astro-cid-3nssi2tu> <!-- Dynamic content --> </div> </div> </div> </div> </div> <div class="mt-8 text-center" data-astro-cid-3nssi2tu> <button id="refresh-user-journey" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900" data-astro-cid-3nssi2tu>
Refresh User Journey Data
</button> </div> </div> ` })}`
  )} </div> ` })}  ${renderScript($$result, "C:/Dev/jason_personal_website/src/pages/dashboard.astro?astro&type=script&index=0&lang.ts")}`;
}, "C:/Dev/jason_personal_website/src/pages/dashboard.astro", void 0);

const $$file = "C:/Dev/jason_personal_website/src/pages/dashboard.astro";
const $$url = "/dashboard";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Dashboard,
  file: $$file,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
